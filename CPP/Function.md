[TOC]

# 版权声明
- C++ 系列读书笔记来源于 Bjarne Stroustrup 所著《C++程序设计原理与实践（基础篇）》；[^1]
- 该系列笔记不以盈利为目的，仅用于记录学习过程中的知识要点和心得体会；
- 如有侵权，请与本人联系（hqpan@foxmail.com），经核实后即刻删除；
- 转载请注明出处；

# 1.elements
## 1.1 concept
- header file （头文件）：声明的集合；
  - 在使用 header file 的源文件和给出 header file 定义的源文件中都包含头文件；
    编译器可捕获声明与定义不一致的错误；
- preprocessing （预处理）：`#include` 的处理逻辑在编译器其它操作之前；
- 同一变量名，可声明多次，但只能定义一次；
- 条件表达式：`(a>=b)?a:b` （推荐的语法）；

## 1.2 scope（作用域）
- 避免使用全局变量和`extern`；
  - 程序设计者难以判断哪段程序读写全局变量；
  - 在不同编译单元中，全局变量的初始化顺序不确定；
  - explanation：实际程序中有大量变量名，局部变量易于管理；
  - 作用域较大的变量，应使用富有描述性的名字；
- 局部函数（嵌套函数）：在 CPP 中支持嵌套调用，不支持嵌套定义；

```cpp
for (int i=0;i<s.size();++i)
```
- `i` 的作用域仅限于该语句；

## 1.3 计算顺序
### 1.3.1 表达式计算
- 赋值运算符 `=` 在算数表达式中并没有特殊地位，因此不能保证 `=` 左侧的子表达式先于右侧的子表达式计算；

```cpp
v[i] = ++i;	// logic exception;
v[++i] = i;	// logic exception;
```

- 以上两行代码均无法确定计算顺序；

## 1.4 namespace
- 全限定名：命名空间的名字（或类名）与成员名的组合；（e.g. `TextLib::Text`）
- using 声明：`using std::string` ；
- using 指令：`using namespace std` ；
- 避免对 `std` 等命名空间之外的名字使用 using 指令；
- 尽量使用全限定名或 using 声明；
- 避免将 using 指令置于 header file 文件之中，否则用户有可能引起名字冲突；


# 2. 变量声明与定义
## 2.1 初始化
```cpp
double d = 7;
vector<int>vi(10);
vector<int>vi2{1,2,3,4};
const int x{9};
```
- 使用 `=` 初始化；
- 使用 `()` 初始化；
- 使用 `{}` 初始化；（被推荐的初始化方法）
- 常量必须初始化；

## 2.2 默认初始化
- string、vector 等对象存在默认构造函数，可不进行初始化；
   - string 默认值为空串 `""`；
   - vector 默认值为空（不包含任何元素）；
- 全局变量默认初始化为 0；
- 局部变量、类成员需要自行初始化；



# 3. 函数调用与返回
## 3.1 concept

```cpp
int my_find(vector<string>vs, string s, int hint);
int my_find(vector<string>, string, int)
```
- 为参数命名；
- 不为参数命名；
- 在函数声明和定义中，可以为参数命名，也可以不命名；

---

- 确保选择语句的每条路径均有 `return` 或 `error`；
- void 函数中无返回值合法，等价于 `return;` ；
- 由于历史原因，main 函数若无返回值，等价于 `return 0` ；
- 值传递：函数中的参数为函数中的局部变量；
- 活动记录栈（也称**调用栈**）、函数活动记录；
  - 调用函数时，活动记录栈写下函数活动记录；
  - 函数返回时，消除函数活动记录；
  - 先进先出；

## 3.2 引用传递
### 3.2.1 传常量引用

```cpp
void print(const vector<double>& v)
{
	// ...
} 

print(vd);
```

- `const` 用于避免函数修改参数；

### 3.2.2 传引用
- `&` 引用的用途之一：作为简写形式；

```cpp
vector<vector<double>>v;
double& var = v[f(x)][g(y)];
```

- 二维 vector 元素的表示形式较为复杂，可使用引用定义别名，以便读写；

### 3.2.3 传常量引用、传引用的区别

```cpp
void g(int a, int& r, const int& cr)
{
	// ...
}

g(1,2,3); // false;
g(1,y,3); // true;
```

- 错误：引用参数需要指向变量；
- 正确：常量引用可以指向字面常量；

---

- 常量引用不需要左值（lvalue）；
- 在 `g(1,y,3);` 语句中，编译器为 `cr` 分配一个整型变量，令 `cr` 指向它；
  - temporary object：由编译器生成的该变量；
- 选用传递方式的原则：
  - 值传递：适用于对象较小；
  - 常量引用传递：适用于无需修改的大对象；
  - 返回值：使用函数返回值；
  - 传引用：迫不得已时使用；



# References
[^1]: Bjarne S. C++程序设计原理与实践（基础篇）[M]. 任明明,王刚,李忠伟, 译. 北京: 机械工业出版社, 2017.